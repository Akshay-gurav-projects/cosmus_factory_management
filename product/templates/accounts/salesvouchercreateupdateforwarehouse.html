{% extends 'product/base.html' %} 
{% load static %} 

{% block body %}
<div>
      
    <form class="mt-3" action="" method="POST" id="salesForm">
      {% csrf_token %}
      <div class="d-flex mb-2">
        <input type="hidden" id="productSaleDate" value="{{dict_to_send}}">
        <label for="" class="me-3">Type:</label>
        <h5 class="text-danger fw-bold">Finish Goods</h5>
        <!-- <input type="text" class="item-select" name="" id="" value="Finish Goods" maxlength="255" readonly> -->
      </div>
      <div class="d-flex mb-3">
        <span id="purchaseError" class="error-messages"></span>
        <div class="d-flex">
          <label for="id_sales_no" class="me-5">Sales No:</label>
          {% if master_form.instance.id %}
          <input type="text" class="item-select" name="sales_no" id="id_sales_no" value="{{master_form.instance.sales_no}}"
            maxlength="255" required readonly>
          {% elif not master_form.instance.id %}
          <input type="text" class="item-select" name="sales_no" id="id_sales_no"
            value="{{master_form.sales_no.initial }}" maxlength="255" required>
          {% endif %}
        </div>
        <span id="SupplierError" class="error-messages"></span>
        <div class="d-flex ms-3">
          <label for="id_buyer_inv_no" class="me-5">Buyer Inv No :</label>
          {% if master_form.instance.id %}
          <input type="text" class="item-select me-5" name="buyer_inv_no" id="id_buyer_inv_no"
            value="{{master_form.instance.buyer_inv_no}}" maxlength="255" readonly>
          {% elif not master_form.instance.id %}
          <input type="text" class="item-select me-5" name="buyer_inv_no" id="id_buyer_inv_no"
            value="{{master_form.instance.buyer_inv_no}}" maxlength="255" required aria-required="true">
          {% endif %}
        </div>
        <div class="d-flex ms-3">
          <label for="id_company_gst" class="ms-1 me-3">Company GST No :</label>
          <input type="text" class="item-select" name="company_gst" id="id_company_gst" value="27AAACG20210238"
            maxlength="50" readonly>
        </div>
      </div>
      <div class="mb-3 d-flex">
        <div class="d-flex">
          <label for="id_ledger_type" class="me-3">ledger Type :</label>
          <input type="text" class="item-select" name="ledger_type" id="id_ledger_type"
            value="{{master_form.instance.ledger_type}}" maxlength="50" default='Sales'
            placeholder="Sales" readonly>
        </div>
        <span id="purchaseError" class="error-messages"></span>
        <div class="d-flex ms-3">
          <label for="id_party_name" class="me-3">Party A/C Name:</label>
          <select class="product2Select text-black" name="party_name" required id="id_party_name">
            {% if master_form.instance.id %}
            <option value="{{master_form.instance.party_name.id}}">
              {{master_form.instance.party_name.name}}</option>
            {% else %}
            <option value="" selected disabled>Select Party name</option>
            {% for x in party_name %}
            <option value="{{x.id}}">{{x.name}}</option>
            {% endfor %}
            {% endif %}
          </select>
          <button  type="button" class="itemCreate_btn popup-trigger" onclick="openPurchasePartyPopup()">+</button>
        </div>
    
    
        <div class="d-flex ms-3">
          <label for="id_GST_number" class="me-2">Party GST No :</label>
          <input type="text" class="item-select" name="GST_number" id="id_GST_number"
            value="{% if master_form.instance.id %}{{ master_form.instance.party_name.Gst_no }}{% endif %}" maxlength="15"
            readonly required>
        </div>
      </div>



    <div class="d-flex mb-3">
      <label for="id_selected_godown" class="me-4">Warehouse:</label>
      <select class="item-select text-black ms-4" name="selected_warehouse" required id="id_selected_warehouse">
        {% if master_form.instance.id %}
        <option value="{{master_form.instance.selected_warehouse.id}}">
          {{master_form.instance.selected_warehouse.warehouse_name_finished}}</option>
        {% else %}
        <option value="" selected disabled>Select Warehouse</option>
        {% for x in warehouse_names %}
        <option value="{{x.id}}">{{x.warehouse_name_finished}}</option>
        {% endfor %}
        {% endif %}
      </select>
    </div>

  <table class="table table-striped table-hover table-responsive" id="salesTable">
    <thead class="name_absolute">
      <tr>
        <th>NO</th>
        <th>Model Names</th>
        <th>Color</th>
        <th>SKU No</th>
        <th>Serial No</th>
        <th>QTY</th>
        <th>MRP</th>
        <th>Customer Price/units</th>
        <th>Treade Discount</th>
        <th>Spl Dlr Discount</th>
        <th>Taxable Value</th>
        <th>Gst</th>
        <th>CGST</th>
        <th>SGST/IGST</th>
        <th>NRP Including GST</th>
        <th>Delete</th>
      </tr>
    </thead>
    <tbody class="mainTableList" id="salesbody">
      {{ formset.management_form }}
      {% for forms in formset %}
      {{ forms.id }}
      <tr>
        <td><input type="number" class="rowNo purchase-mark bg-transparent border-0" name="rowNo_{{forloop.counter0}}" id="rowNo_{{forloop.counter0}}" value="{{forloop.counter}}"></td>
        <td> 
          <div class="custom-dropdown-container">
            <input type="hidden" name="{{forms.prefix}}-product_name" id="id_{{forms.prefix}}-product_name"  value="{% if forms.instance.id %}{{forms.instance.product_name.PProduct_SKU}}{% endif %}" > 
            <input type="text" name="{{forms.prefix}}-product_name_value" id="id_{{forms.prefix}}-product_name_Value" class="productpurchaseInvoice search-input"  placeholder="Product Name" autocomplete="off" value="{% if forms.instance.id %}{{forms.instance.product_name.Product.Model_Name}} {% endif %}" > 
            <div name="select_product_name_{{forloop.counter0}}" class="productpurchaseInvoice product-name s-suggestion-container item-select_input" id="select_product_name_{{forloop.counter0}}" style="display: none; height:auto;" dir="auto" spellcheck="false" tabindex="0" aria-label="Product Name" >
              
           
             </div>
        </div> 
        </td>
        <td><input type="text" name="product_color_{{forloop.counter0}}" id="product_color_{{forloop.counter0}}" value="{{forms.instance.product_name.PProduct_color}}" class="purchase-input" style="margin-left: 10px;" readonly></td>

        <td><input type="text" name="product_Sku_{{forloop.counter0}}" id="product_Sku_{{forloop.counter0}}" value="{{forms.instance.product_name.PProduct_SKU}}" class="purchase-amount" readonly></td>

        <td><input type="text" name="serial_No_{{forloop.counter0}}" id="serial_No_{{forloop.counter0}}" value="{{forms.instance.product_name.PProduct_SKU}}" class="purchase-amount" readonly></td>

        <td><input type="number" id="id_{{forms.prefix}}-quantity" class="purchase-input sales-qunatity" name="{{forms.prefix}}-quantity" value="{{forms.instance.quantity | default_if_none:'' }}" ></td>

        <td><input type="number" id="id_{{forms.prefix}}-mrp" class="purchase-input sales-mrp" name="{{forms.prefix}}-mrp" value="{{forms.instance.product_name.Product.Product_MRP}}" readonly></td>

        <td><input type="number" id="id_{{forms.prefix}}-sale_price" class="purchase-input sales_price" name="{{forms.prefix}}-sale_price" value="{{forms.instance.product_name.Product.Product_SalePrice_CustomerPrice}}" readonly></td>


        <td><input type="number" id="id_{{forms.prefix}}-trade_disct" class="purchase-input sales-trade_disct" name="{{forms.prefix}}-trade_disct" value="{{forms.instance.trade_disct | default_if_none:'' }}" ></td>


        <td><input type="number" id="id_{{forms.prefix}}-spl_disct" class="purchase-input sales-spl_disct" name="{{forms.prefix}}-spl_disct" value="{{forms.instance.spl_disct | default_if_none:'' }}" ></td>
        <td>
          <input type="number" id="id_{{forms.prefix}}-amount" class="purchase-amount total-amount" name="{{forms.prefix}}-amount" value="{{forms.instance.amount | default_if_none:''}}" readonly>
      </td>
      <td>
          
          <input type="number" id="id_{{forms.prefix}}-gst" class="purchase-mark purchase-gst" name="{{forms.prefix}}-gst" value="{{ forms.instance.product_name.Product.Product_GST.gst_percentage }}" readonly >
      </td>
      <td>
          <input type="number" id="id_{{forms.prefix}}-cgst" class="purchase-input purchase-cgst" name="{{forms.prefix}}-cgst" value=""readonly >
      </td>
      <td>
          <input type="number" id="id_{{forms.prefix}}-sgst" class="purchase-input purchase-sgst" name="{{forms.prefix}}-sgst" value=""readonly >
      </td>
      <td><input type="number" id="{{forms.prefix}}-total_amount" class="purchase-amount purchase-total" name="{{forms.prefix}}-total_amount" value="" readonly></td>
      <td><span class="delete-btn border-0 bg-transparent" style="cursor: pointer;"><i class="fa-solid fa-trash text-danger px-3 py-2 fs-6"><input type="checkbox" class="godown_deleteId px-2" style="display: none;"  name="{{forms.prefix}}-DELETE" id="id_{{forms.prefix}}-DELETE" value="" ></i></span></td>  
    </tr>
      {% endfor %}
    </tbody>
    <tbody>
      <tr>
          <td class="text-center fw-bold" ><span>Total</span></td>
          <td colspan="3"></td>
          <td> <input type="number" class="purchase-input" style="border: 1px solid red;" name="grand_quantity" id ="id_grand_quantity" value="" maxlength="50" step=".01" readonly></td>
          <td colspan="4"></td>
          <td><input type="number" class="purchase-amount" style="border: 1px solid red;"  name="grand_taxableAmount" id ="id_grand_taxableAmount" value="" maxlength="50" step=".01" readonly ></td>
          <td></td>
          <td><input type="number" class="purchase-input" style="border: 1px solid red;" name="grand_cgst" id ="id_grand_cgst" value="" maxlength="50" step=".01" readonly></td>
          <td><input type="number" class="purchase-input" style="border: 1px solid red; " name="grand_Sgst" id ="id_grand_sgst" value="" maxlength="50" step=".01" readonly > </td>
          <td> <input type="number" class="purchase-amount" style="border: 1px solid red;" name="grand_amount" id ="id_grand_amount" value="" maxlength="50" step=".01" readonly></td>
      </tr>
  </tbody>
  </table>

  
  <div class="row">
    <div class="col-lg-9">
        <div class="ms-2">
            <input type="number" class="product_row" name="productRow" id="id_productRow" value="1">
            <button type="button" class="item-btn mb-3" id="addRowButton">Add +</button>
        </div>
        <div class="row">
          <div class="col-lg-10">
            <label class="fw-bold text-dark">Tax Summary :</label>
            <table class="table table-striped table-hover table-bordered table-responsive" id="taxSummary">
              <thead class="name_absolute">
                <tr>
                  <th>Taxable Value</th>
                  <th colspan="2">CGST</th>
                  <th colspan="2">SGST/IGST</th>
                  <th></th>
                </tr>
              <tr>
                <th></th>
                <th>Rate</th>
                <th>Amount</th>
                <th>Rate</th>
                <th>Amount</th>
                <th>TOTAL AMT</th>
              </tr>
              </thead>
              <tbody class="mainTableList">
                <tr>
              
                </tr>
                <tr class="Total">
                 
                </tr>
              </tbody>
  
            </table>
          </div>
         
        </div>
       
    </div>
  <div class="col-lg-3" id="saleTotal">
    <div class="mb-4">
        <div class=" mb-3">
            <label  class="purchase-lable fw-bold">Gross total</label>
            <span class="purchase-span">
                <input type="number" class="purchaseTableLabel-Gtotal  purchase-amounts" name="gross_total" id ="id_gross_total" value="{{master_form.instance.gross_total | default_if_none:''}}" maxlength="50" step=".01" readonly >
            </span>           
        </div>
        <div class=" mb-3">
          <label class="purchase-lable fw-bold">Cash Disct <input type="number" name="cash_disct" class="product_row" id="id_cash_disct" value="{{ master_form.instance.cash_disct | default_if_none:'0'}}" maxlength="50" step=".01">% </label>
          <span class="purchase-span">
              <input type="number" class="purchaseTableLabel-transport  purchase-amounts" name="cash_disct_value" id ="id_cash_disct_value" value="" maxlength="50" step=".01" readonly >
          </span>
      </div>
        <div class=" mb-3">
            <label class="purchase-lable fw-bold">Fright & Transport</label>
            <span class="purchase-span">
                <input type="number" class="purchaseTableLabel-transport  purchase-amounts" name="fright_transport" id ="id_fright_transport" value="{{master_form.instance.fright_transport | default_if_none:'0'}}" maxlength="50" step=".01" required >
            </span>
        </div>
        <div class=" mb-3">
            <input type="hidden" id="temp_grand_total" value="">
            <label class="purchase-lable fw-bold">Round Of </label>
            <span class="purchase-span">
                <input type="number" class="purchaseTableLabel-roundOf  purchase-amounts" name="round_off" id ="id_round_off" value="" maxlength="50" step=".01" readonly required>
            </span> 
        </div>
    
        <div class=" mb-3">
            <label class="purchase-lable fw-bold">Grand total</label>
            <span class="purchase-span"><input type="number" class="purchaseTableLabel-total purchase-amounts" name="grand_total" value="{{master_form.instance.grand_total | default_if_none:''}}" id="id_grand_total" step=".01" readonly required></span> 
        </div>
    </div>
  </div>
  </div>
<button type="submit" class="ms-5 newProductCreateBtn" id="parentFormClick">Submit</button>


</div>
{% endblock body %}